import{d as T,G as I,r as f,A as a,I as b,J as M,R as h,V,f as P,Y as R,q as B,n as C,b as F,L as $,M as s,t as c,N as y,O as w,P as j,X as q}from"./vendor.5af50741.js";import{_ as D}from"./logo.50226ed7.js";import{_ as U}from"./index.929b23ea.js";import"./expansion-moment.d5a89207.js";import"./expansion-axios.5452c070.js";var E="./img/login/name.png",N="./img/login/password.png";const W=T({setup(){const e=a.t,o=I({username:"",password:""}),u=f(),p=f(),_=f(a.Config.UI?.SiteTitle),n=b(),t=M();let r=decodeURIComponent(t.query?.redirect||"/");const v=h();let g;if(v){V(v),n&&n.replace(r).then(d=>{t.name=="login"&&n.replace("/")});return}const k=async()=>{if(o.username.trim()===""||o.password.trim()=="")return a.Message?.warn(e("sys.login.loginEmtyWarnInfo"));let d={username:o.username.trim(),pwd:j.MD5(o.password)};const l=await q(d);if(!l){a.Message?.warn(e("sys.login.loginFailTitle"));return}if(l.isSuccess){const i=decodeURIComponent(t.query?.redirect||"/");if(n)if(console.log(i,"toPath"),i.startsWith("http://")||i.startsWith("https://")){const m=h();window.open(i+"#/?tk="+m.token,"_self")}else n.replace(i).then(m=>{t.name=="login"&&n.replace("/")});a.Message?.msg(e("sys.login.loginSuccessTitle"))}else a.Message?.warn(l.ResultDescription||e("sys.login.loginFailTitle"))};P(async()=>{if(r&&(g=t.query?.tk?.toString()),g){const d=await R(g);console.log(d,"\u8F93\u51FAcheckToken\u7684\u7ED3\u679C00");const l=d?.data;if(l)if(l.isSuccess){B(l.resultValue),C(l.resultValue.doubleToken),a.Message?.msg(e("sys.login.loginSuccessTitle"));const i=h();i&&(r?.indexOf("?")>0?r+="&tk="+i.token:r+="?tk="+i.token,n.replace(r).then(m=>{t.name=="login"&&n.replace("/")}))}else a.Message?.warn(e("sys.login.loginTokenFailInfo"))}});function S(){u.value&&(u.value.placeholder=e("sys.login.accountPlaceholder")),p.value&&(p.value.placeholder=e("sys.login.passwordPlaceholder"))}return{formState:o,systemTitle:_,handleSubmit:k,t:e,onblur:S,nameInput:u,pwdInput:p}}}),A={class:"container"},O={class:"login-logo"},X=s("img",{src:D,alt:""},null,-1),Y={class:"login-title"},G={class:"login"},J={class:"login-top"},L={class:"login-center clearfix"},x=s("div",{class:"login-center-img"},[s("img",{src:E})],-1),z={class:"login-center-input"},H=["placeholder"],K={class:"login-center-input-text"},Q={class:"login-center clearfix"},Z=s("div",{class:"login-center-img"},[s("img",{src:N})],-1),ee={class:"login-center-input"},se=["placeholder"],oe={class:"login-center-input-text"};function te(e,o,u,p,_,n){return F(),$("div",A,[s("div",O,[X,s("span",Y,c(e.systemTitle),1)]),s("div",G,[s("div",J,c(e.t("sys.login.signInFormTitle")),1),s("div",L,[x,s("div",z,[y(s("input",{ref:"nameInput",type:"text",placeholder:e.t("sys.login.accountPlaceholder"),onfocus:"this.placeholder=''",onBlur:o[0]||(o[0]=t=>e.onblur()),"onUpdate:modelValue":o[1]||(o[1]=t=>e.formState.username=t)},null,40,H),[[w,e.formState.username]]),s("div",K,c(e.t("sys.login.userName")),1)])]),s("div",Q,[Z,s("div",ee,[y(s("input",{ref:"pwdInput",type:"password",placeholder:e.t("sys.login.passwordPlaceholder"),onfocus:"this.placeholder=''",onBlur:o[2]||(o[2]=t=>e.onblur()),"onUpdate:modelValue":o[3]||(o[3]=t=>e.formState.password=t)},null,40,se),[[w,e.formState.password]]),s("div",oe,c(e.t("sys.login.password")),1)])]),s("div",{class:"login-button",onClick:o[4]||(o[4]=(...t)=>e.handleSubmit&&e.handleSubmit(...t))},c(e.t("sys.login.loginButton")),1)])])}var de=U(W,[["render",te]]);export{de as default};
